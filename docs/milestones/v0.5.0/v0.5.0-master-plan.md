# v0.5.0 마스터 플랜 (Master Plan)

> **마일스톤**: `v0.5.0 - Obsidian Vault Integration Refactor`  
> **목표**: v1.0 Obsidian Community Plugin 전환 직전의 plugin-ready 기반 완성  
> **관련 이슈**: [#140](https://github.com/PJH720/VoiceVault/issues/140)  
> **작성일**: 2026-02-25  
> **상태**: 🟡 진행 중

---

## 1. 개요 (Overview)

v0.5.0은 VoiceVault를 Obsidian Community Plugin으로 전환하기 전의 **마지막 기반 정비 마일스톤**입니다.

v0.4.0에서 Next.js 프론트엔드와 Python 백엔드 분리가 완료되었습니다.  
v0.5.0에서는 두 가지 새로운 레이어를 추가합니다:

1. **Obsidian Plugin 레이어** (`plugin/`): TypeScript 기반, Obsidian Plugin API 사용
2. **문서 기반 확정**: 구현 전에 ADR(Architecture Decision Record)로 설계 결정을 고정

---

## 2. 범위 (Scope)

### ✅ In Scope

| 카테고리 | 내용 |
|----------|------|
| 문서화 | ADR-001, ADR-002, ADR-003, plugin-feature-spec, obsidian-ux-flow |
| Plugin 기반 | 스캐폴드, 수명주기 관리, SettingTab, HTTP 클라이언트 |
| 타입 동기화 | OpenAPI → Plugin 타입 자동 생성 파이프라인 |
| Frontend | RAG Search 페이지 (Next.js), Export 페이지 (Next.js) |
| Vault 통합 | Export 서비스 리팩토링, Vault adapter 패턴 |
| 품질 보증 | 테스트 계획, 보안 감사, 성능 벤치마크 |
| 릴리즈 | v0.5.0 릴리즈 체크리스트 및 드라이런 |
| 정리 | Streamlit soft removal (경고 + 문서 갱신) |

### ❌ Out of Scope

- Community Plugin 공식 제출/승인 완료 (→ v1.0)
- 모바일(iOS/Android) 완성
- 백엔드 전면 재작성
- 모든 기능의 동시 포팅
- Streamlit 완전 제거 (→ v0.6.0)

---

## 3. 이슈 목록 및 Phase 배정

전체 18개 이슈. 의존성 기반 실행 순서는 [`execution-order.md`](execution-order.md) 참조.

| Phase | 이슈 | 제목 | 우선순위 | 예상 소요 |
|-------|------|------|----------|-----------|
| 0 | #140 | v0.5.0 마스터 플랜 문서 작성 | P0 | 1d |
| 0 | #141 | ADR-001 플러그인-백엔드 경계 설계 | P0 | 1d |
| 0 | #142 | ADR-002 데이터 소유권 결정 | P0 | 1d |
| 0 | #143 | ADR-003 보안 및 샌드박싱 정책 수립 | P0 | 1d |
| 0 | #144 | 플러그인 기능 명세서 (plugin-feature-spec) | P0 | 2d |
| 0 | #145 | Obsidian UX 플로우 설계 | P1 | 1d |
| 1 | #146 | Plugin 스캐폴드 및 수명주기 관리 | P0 | 3d |
| 1 | #147 | Plugin-Backend OpenAPI 타입 동기화 | P0 | 2d |
| 1 | #157 | Backend CORS 및 Plugin 미들웨어 | P1 | 1d |
| 2 | #148 | RAG Search 페이지 (Next.js) | P1 | 3d |
| 2 | #149 | Export 페이지 (Next.js) | P1 | 2d |
| 2 | #150 | Vault 통합 리팩토링 | P1 | 3d |
| 2 | #151 | Plugin HTTP 클라이언트 | P1 | 2d |
| 3 | #152 | 테스트 계획 및 스위트 구축 | P0 | 3d |
| 3 | #153 | 성능 벤치마크 및 최적화 | P1 | 2d |
| 3 | #154 | 보안 감사 및 취약점 검증 | P0 | 2d |
| 3 | #155 | 릴리즈 체크리스트 작성 및 검증 | P1 | 2d |
| 3 | #156 | Streamlit soft removal | P2 | 1d |

**총 예상 소요**: 직렬 33일 · **병렬 최소 14일** (크리티컬 패스 기준)

---

## 4. 주간 실행 로드맵

```
Week 1 (Day 0~7)                Week 2 (Day 7~14)
─────────────────────────       ─────────────────────────
Day 0:  Batch A 착수             Day 7:  Batch D 착수
  └─ #140 마스터 플랜              └─ #147 타입 동기화
  └─ #141 ADR-001                 └─ #150 Vault 통합 리팩토링
  └─ #142 ADR-002
  └─ #143 ADR-003               Day 8:  Batch E 착수
                                  └─ #151 HTTP 클라이언트
Day 1:  Batch B 착수
  └─ #144 기능 명세서            Day 9:  Batch F 착수
  └─ #157 CORS 미들웨어           └─ #152 테스트 계획·스위트
  └─ #148 RAG Search 페이지       └─ #153 성능 벤치마크
  └─ #149 Export 페이지
                                Day 10: Batch G 착수
Day 3:  Batch C 착수              └─ #154 보안 감사
  └─ #146 Plugin 스캐폴드
  └─ #145 UX 플로우 설계        Day 12: Batch H 착수
                                  └─ #155 릴리즈 체크리스트
Day 6:  Batch D 착수              └─ #156 Streamlit soft removal
  └─ (→ Week 2)
                                Day 14: ✅ v0.5.0 완료 목표
```

---

## 5. 의존성 그래프 요약

자세한 Mermaid DAG는 [`execution-order.md §Section A`](execution-order.md) 참조.

**크리티컬 패스**:
```
#141 → #144 → #146 → #150 → #152 → #155  (총 14일)
```

**핵심 블로커**:
- `#141` ADR-001: 하위 6개 이슈의 직접 전제 조건
- `#146` Plugin 스캐폴드: Batch D~H 전체의 전제 조건
- `#152` 테스트 스위트: 릴리즈 직전 게이트

---

## 6. 리스크 및 완화 전략

| 리스크 | 확률 | 영향 | 완화 전략 |
|--------|------|------|-----------|
| Obsidian Plugin API 호환성 이슈 | 중 | 높음 | obsidian-sample-plugin 레퍼런스 준수, `obsidianmd/obsidian-api` TypeScript 타입 활용 |
| Plugin↔Backend CORS 설정 복잡도 | 중 | 중 | ADR-001에서 사전 결정, #157 Early 착수 |
| Vault 파일 쓰기 충돌 (동시 접근) | 낮 | 높음 | `app.vault.process()` 원자적 쓰기 패턴 사용 |
| OpenAPI 타입 동기화 깨짐 | 중 | 중 | CI에 타입 체크 job 추가, `make gen-types` 강제 |
| 테스트 커버리지 부족으로 릴리즈 차단 | 낮 | 높음 | #152를 Batch F 최우선으로 착수, E2E 1개 이상 필수 |
| Streamlit 관련 회귀 발생 | 낮 | 낮음 | #156은 P2로 릴리즈 마지막에 처리 |

---

## 7. 필수 산출물 (DoD 체크리스트)

마일스톤 완료 조건:

- [ ] **문서 패키지** 완성 (ADR-001~003, plugin-feature-spec, obsidian-ux-flow, test-plan, release-checklist)
- [ ] **Plugin 스캐폴드** — Obsidian에서 로드/언로드 에러 없음
- [ ] **핵심 플로우 E2E** — RAG 검색 쿼리 → 결과 표시 자동화 테스트 1개 이상 통과
- [ ] **기존 REST/WebSocket 계약 회귀 없음** — 기존 테스트 `pytest tests/ -v` 전체 통과
- [ ] **릴리즈 절차 재현 가능** — 드라이런 1회 성공
- [ ] **보안 감사 통과** — ADR-003 체크리스트 전항목, `npm audit` / `pip-audit` critical 0건

---

## 8. 참고 문서

| 문서 | 위치 | 목적 |
|------|------|------|
| Context Pack | `docs/milestones/v0.5.0/README.md` | 마일스톤 배경 |
| Execution Order | `docs/milestones/v0.5.0/execution-order.md` | 실행 순서 및 DAG |
| ADR-001 | `docs/milestones/v0.5.0/ADR-001-plugin-backend-boundary.md` | Plugin↔Backend 경계 |
| ADR-002 | `docs/milestones/v0.5.0/ADR-002-data-ownership-vault-vs-db.md` | 데이터 소유권 |
| ADR-003 | `docs/milestones/v0.5.0/ADR-003-security-and-sandboxing.md` | 보안 정책 |
| Plugin Feature Spec | `docs/milestones/v0.5.0/plugin-feature-spec.md` | 기능 명세 |
| Obsidian UX Flow | `docs/milestones/v0.5.0/obsidian-ux-flow.md` | UX 흐름 |
| Test Plan | `docs/milestones/v0.5.0/v0.5.0-test-plan.md` | 테스트 전략 |
| Release Checklist | `docs/milestones/v0.5.0/v0.5.0-release-checklist.md` | 릴리즈 절차 |
| CLAUDE.md | `CLAUDE.md` | 프로젝트 구조·컨벤션 |
| AGENTS.md | `AGENTS.md` | 에이전트 운영 규칙 |
| Roadmap | `wiki/Roadmap.md` | 전체 마일스톤 로드맵 |

---

*이 문서는 v0.5.0 마일스톤의 모든 이슈와 1:1로 매핑되며, 실행 중 발견된 사항은 지속 업데이트됩니다.*  
*Closes #140*
